{% extends 'attivita_scheda.html' %}

{% load humanize %}
{% load thumbnail %}
{% load gravatar %}

{% block scheda_titolo %}
    Turni
{% endblock %}

{% block scheda_contenuto %}

    {% include 'attivita_scheda_turni_inc_paginazione.html' %}


    <table class="table table-striped table-responsive">
        <tbody>
        {% for turno in turni %}

            <tr {% if turno.scoperto and turno.futuro %}class="warning"{% endif %}>
                <td>
                    <p>
                        <h4>
                            {{ turno.nome }}
                        </h4>

                    </p>

                    <p>
                        <span class="piu-grande">
                            <i class="fa fa-fw fa-clock-o"></i>
                            <strong>{{ turno.inizio.date|naturalday:"SHORT_DATE_FORMAT" }} alle {{ turno.inizio.time }}</strong><br />
                        </span>
                        fino a {{ turno.fine.date|naturalday:"SHORT_DATE_FORMAT" }} alle {{ turno.fine.time }}<br />

                    </p>
                </td>

                <td>
                    <p>
                       <i class="fa fa-fw fa-users"></i> <strong>{{ turno.partecipazioni_confermate.count }} partecipanti confermati</strong>
                     <span class="text-muted">(minimo {{ turno.minimo }}, massimo {{ turno.massimo }})</span>
                    </p>

                    {% if turno.scoperto %}
                        <p class="text-danger">
                            <i class="fa fa-fw fa-warning"></i> Scoperto!
                        </p>
                    {% endif %}

                    {% if turno.pieno %}
                        <p class="text-danger">
                            <i class="fa fa-fw fa-warning"></i> Pieno!
                        </p>
                    {% endif %}

                    <p>
                        {% for p in turno.partecipazioni_confermate %}
                            {% thumbnail p.persona.avatar "50x50" crop="center" as im %}
                                <a href="{{ p.persona.url }}" title="{{ p.persona.nome_completo }}">
                                    <img    src="{{ im.url }}" class="img-rounded"
                                            alt="{{ p.persona.nome_completo }}"
                                            title="{{ p.persona.nome_completo }} "/>
                                </a>

                            {% empty %}
                                <a href="{{ p.persona.url }}" title="{{ p.persona.nome_completo }}">
                                    <img    src="{% gravatar_url p.persona.email 50 %}" class="img-rounded"
                                            alt="{{ p.persona.nome_completo }}"
                                            title="{{ p.persona.nome_completo }} "/>
                                </a>

                            {% endthumbnail %}
                        {% endfor %}


                    </p>

                </td>

                <td>

                    {% include 'attivita_turno_inc_azioni.html' %}


                </td>


            </tr>

        {% empty %}


        {% endfor %}
        </tbody>
    </table>

    {% include 'attivita_scheda_turni_inc_paginazione.html' %}


{% endblock %}